{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{Box,Typography,Paper,List,ListItem,ListItemText,TextField,Button,Drawer,IconButton,Avatar}from'@mui/material';import{MapContainer,TileLayer,Marker,Tooltip,useMap,Circle,Popup,LayersControl,LayerGroup,Polyline}from'react-leaflet';import'leaflet/dist/leaflet.css';import L from'leaflet';import MyLocationIcon from'@mui/icons-material/MyLocation';import FilterListIcon from'@mui/icons-material/FilterList';import MenuItem from'@mui/material/MenuItem';// @ts-ignore\nimport MarkerClusterGroup from'react-leaflet-cluster';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL='http://localhost:4000/api/markers';const RESOURCES_API='http://localhost:4000/api/resources';// Varsayılan marker ikonunu düzeltmek için\nconst iconUrl=require('leaflet/dist/images/marker-icon.png');const iconShadow=require('leaflet/dist/images/marker-shadow.png');const defaultIcon=L.icon({iconUrl,shadowUrl:iconShadow,iconAnchor:[12,41]});L.Marker.prototype.options.icon=defaultIcon;const center=[39.9208,32.8541];// Ankara merkez\nconst resourceTypeIcons={sivrisinek:'https://cdn-icons-png.flaticon.com/512/17275/17275339.png',karasinek:'https://cdn-icons-png.flaticon.com/512/12311/12311394.png',cop:'https://cdn-icons-png.flaticon.com/512/7657/7657533.png',logar:'https://cdn-icons-png.flaticon.com/512/4357/4357706.png'};const criticalIconUrl='https://cdn-icons-png.flaticon.com/512/564/564619.png';// turuncu\nconst expiredIconUrl='https://cdn-icons-png.flaticon.com/512/564/564623.png';// kırmızı\nconst MapPage=()=>{const[markers,setMarkers]=useState([]);const[resources,setResources]=useState([]);const[error,setError]=useState('');const[desc,setDesc]=useState('');const[pendingLatLng,setPendingLatLng]=useState(null);const[loading,setLoading]=useState(false);const[myPosition,setMyPosition]=useState(null);const[filterOpen,setFilterOpen]=useState(false);const[filterType,setFilterType]=useState('');const[filterIlce,setFilterIlce]=useState('');const[filterMahalle,setFilterMahalle]=useState('');const[selectedResourceIds,setSelectedResourceIds]=useState([]);const[searchText,setSearchText]=useState('');const[searchMatchedId,setSearchMatchedId]=useState(null);const[rotaKaynakIds,setRotaKaynakIds]=useState([]);const[rotaType,setRotaType]=useState('');const[rotaIlce,setRotaIlce]=useState('');const[rotaMahalle,setRotaMahalle]=useState('');const[rotaPolyline,setRotaPolyline]=useState([]);const[rotaLoading,setRotaLoading]=useState(false);const[rotaOzet,setRotaOzet]=useState(null);const mapRef=useRef(null);// İlçe ve mahalleler (örnek, gerekirse dışarıdan alınabilir)\nconst ilceler=['Altıeylül','Ayvalık','Balya','Bandırma','Bigadiç','Burhaniye','Dursunbey','Edremit','Erdek','Gömeç','Gönen','Havran','İvrindi','Karesi','Kepsut','Manyas','Marmara','Savaştepe','Sındırgı','Susurluk'];const mahalleler=['KADİKÖY','KAVAK ALANI','GÖKMUSA','SÖBÜCEALAN','KARLIK','ILICA','YENİKAVAK','YARIŞALALANI','KARACAHİSAR','KAYALAR','SEMİZKÖY','ÖREN','DANIŞMENT','GÖLOBA','KOYUNERİ','ORHANLAR','DEĞİRMENDERE','MANCILIK','DEREKÖY','KARAMUSTAFALAR','ÇALOVA','YAZLIK','ÇUKURCAK','KAYAPINAR','MÜSTECAP','BENGİLER','ÇİĞDEM','ÇAMAVŞAR','ÇAMUCU','FARSAK','ÇARMIK','YAYLACIK','HAVUTBAŞI','DOĞANLAR','ÇAKALLAR','YUKARI ÇAKALLAR','KAŞIKÇI','HABİPLER','GÖKTEPE','AKBAŞ','KOCABÜK','MEDRESE','HACIHÜSEYİN','NARLI','ALİDEMİRCİ','AKÇAL','PATLAK','KOCACAMİ','ENVERPAŞA'].sort((a,b)=>a.localeCompare(b,'tr'));// Filtreye uyan kaynaklar\nconst filteredResources=resources.filter(res=>{if(filterType&&res.type!==filterType)return false;if(filterIlce&&res.ilce!==filterIlce)return false;if(filterMahalle&&res.mahalle!==filterMahalle)return false;return true;});// Rota için filtrelenmiş kaynaklar\nconst rotaFilteredResources=resources.filter(res=>{if(rotaType&&res.type!==rotaType)return false;if(rotaIlce&&res.ilce!==rotaIlce)return false;if(rotaMahalle&&res.mahalle!==rotaMahalle)return false;return true;});// Arama işlemi\nuseEffect(()=>{if(!searchText){setSearchMatchedId(null);return;}const found=filteredResources.find(res=>res.type&&res.type.toLowerCase().includes(searchText.toLowerCase())||res.mahalle&&res.mahalle.toLowerCase().includes(searchText.toLowerCase())||res.adres&&res.adres.toLowerCase().includes(searchText.toLowerCase()));if(found&&mapRef.current){setSearchMatchedId(found.id);mapRef.current.setView([parseFloat(found.lat),parseFloat(found.lng)],15);}else{setSearchMatchedId(null);}},[searchText]);// Canlı konumu al\nuseEffect(()=>{let watchId=null;if(navigator.geolocation){watchId=navigator.geolocation.watchPosition(pos=>setMyPosition([pos.coords.latitude,pos.coords.longitude]),undefined,{enableHighAccuracy:true,maximumAge:10000,timeout:20000});}return()=>{if(watchId!==null&&navigator.geolocation){navigator.geolocation.clearWatch(watchId);}};},[]);// Hem işaretleri hem kaynakları çek\nuseEffect(()=>{fetch(API_URL).then(res=>res.json()).then(data=>setMarkers(data)).catch(()=>setError('İşaretler alınamadı!'));fetch(RESOURCES_API).then(res=>res.json()).then(data=>setResources(data)).catch(()=>setError('Kaynaklar alınamadı!'));},[]);// Haritaya tıklanınca açıklama formunu aç\nconst handleAddMarker=(lat,lng)=>{setPendingLatLng({lat,lng});};// Formdan işareti ekle\nconst handleSubmit=async e=>{e.preventDefault();if(!pendingLatLng)return;setLoading(true);try{const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({lat:pendingLatLng.lat,lng:pendingLatLng.lng,desc})});const data=await res.json();if(res.ok){setMarkers(prev=>[...prev,data]);setDesc('');setPendingLatLng(null);}else{setError(data.error||'İşaret eklenemedi!');}}catch(_unused){setError('Sunucuya ulaşılamıyor!');}setLoading(false);};// Konumuma git butonu\nfunction GoToMyLocation(_ref){let{position}=_ref;const map=useMap();return/*#__PURE__*/_jsx(Box,{sx:{position:'absolute',bottom:{xs:16,md:24},right:{xs:16,md:24},zIndex:1200,display:'flex',flexDirection:'column',alignItems:'flex-end'},children:/*#__PURE__*/_jsx(IconButton,{color:\"primary\",size:\"large\",sx:{bgcolor:'white',boxShadow:3,width:{xs:64,sm:56},height:{xs:64,sm:56},borderRadius:'50%',border:'2px solid #1976d2','&:hover':{bgcolor:'#e3f2fd'},opacity:position?1:0.5,pointerEvents:position?'auto':'none'},onClick:()=>{if(position)map.setView(position,15);},disabled:!position,children:/*#__PURE__*/_jsx(MyLocationIcon,{sx:{fontSize:{xs:38,sm:32},color:'#1976d2'}})})});}// localStorage'dan ilaçlanma sürelerini oku\nconst defaultSureler={sivrisinek:{gun:15,saat:0,dakika:0},karasinek:{gun:15,saat:0,dakika:0},cop:{gun:20,saat:0,dakika:0},logar:{gun:10,saat:0,dakika:0}};let ilaclanmaSureleri=defaultSureler;try{const stored=localStorage.getItem('ilaclamaSureleri');if(stored)ilaclanmaSureleri=JSON.parse(stored);}catch(_unused2){}// Kalan süre hesaplama fonksiyonu (örnek: 15 gün)\nfunction kalanSure(res){if(!res.ilaclandiMi||!res.ilaclamaZamani)return'-';const sure=ilaclanmaSureleri[res.type]||{gun:15,saat:0,dakika:0};const gun=Number(sure.gun)||0;const saat=Number(sure.saat)||0;const dakika=Number(sure.dakika)||0;const ILACLAMA_SURESI=gun*24*60*60+saat*60*60+dakika*60;const start=new Date(res.ilaclamaZamani).getTime();const now=Date.now();const diff=Math.floor((now-start)/1000);let kalanSn=ILACLAMA_SURESI-diff;if(!isFinite(kalanSn)||isNaN(kalanSn)||kalanSn<=0)return'Süresi Doldu';const kalanGun=Math.floor(kalanSn/(24*60*60));const kalanSaat=Math.floor(kalanSn%(24*60*60)/3600);const kalanDk=Math.floor(kalanSn%3600/60);return\"Kalan S\\xFCre: \".concat(kalanGun,\"g \").concat(kalanSaat,\"s \").concat(kalanDk,\"dk\");}// Hızlı ilaçla fonksiyonu\nconst handleIlacla=async res=>{if(!res.id)return;const now=new Date().toISOString();try{await fetch(\"\".concat(RESOURCES_API,\"/\").concat(res.id),{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({ilaclamaZamani:now,ilaclandiMi:true})});// Kaynakları güncelle\nfetch(RESOURCES_API).then(res=>res.json()).then(data=>setResources(data));}catch(_unused3){}};// Marker seçme/çıkarma\nconst handleSelectResource=id=>{setSelectedResourceIds(prev=>prev.includes(id)?prev.filter(i=>i!==id):[...prev,id]);};// Toplu ilaçla\nconst handleBulkIlacla=async()=>{const now=new Date().toISOString();await Promise.all(selectedResourceIds.map(async id=>{await fetch(\"\".concat(RESOURCES_API,\"/\").concat(id),{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({ilaclamaZamani:now,ilaclandiMi:true})});}));// Kaynakları güncelle\nfetch(RESOURCES_API).then(res=>res.json()).then(data=>setResources(data));setSelectedResourceIds([]);};// Seçimi temizle\nconst handleClearSelection=()=>setSelectedResourceIds([]);// İstatistikler\nconst toplamKaynak=resources.length;let aktifKaynak=0,kritikKaynak=0,dolanKaynak=0;resources.forEach(res=>{if(res.ilaclandiMi&&res.ilaclamaZamani){const sure=ilaclanmaSureleri[res.type]||{gun:15,saat:0,dakika:0};const gun=Number(sure.gun)||0;const saat=Number(sure.saat)||0;const dakika=Number(sure.dakika)||0;const ILACLAMA_SURESI=gun*24*60*60+saat*60*60+dakika*60;const start=new Date(res.ilaclamaZamani).getTime();const now=Date.now();const diff=Math.floor((now-start)/1000);const kalanSn=ILACLAMA_SURESI-diff;if(!isFinite(kalanSn)||isNaN(kalanSn)||kalanSn<=0)dolanKaynak++;else if(kalanSn<3*24*60*60)kritikKaynak++;else aktifKaynak++;}else{aktifKaynak++;}});// Rota oluştur\nconst handleRotaOlustur=async()=>{if(!myPosition){alert('Anlık konum alınamadı! Lütfen konum izni verin veya konumunuzu açın.');return;}if(rotaKaynakIds.length<1){alert('En az 1 kaynak seçmelisiniz!');return;}setRotaLoading(true);// id eşleşmesini hem string hem number olarak yap\nconst selected=rotaFilteredResources.filter(r=>rotaKaynakIds.includes(r.id)||rotaKaynakIds.includes(String(r.id)));if(selected.length<1){alert('Seçili kaynaklar bulunamadı!');setRotaLoading(false);return;}// Başlangıç noktası olarak anlık konum ekle\nconst coords=[[myPosition[1],myPosition[0]],...selected.map(r=>[parseFloat(r.lng),parseFloat(r.lat)])];if(coords.some(c=>isNaN(c[0])||isNaN(c[1]))){alert('Seçili kaynaklardan birinin koordinatı eksik veya hatalı!');setRotaLoading(false);return;}const coordStr=coords.map(c=>c.join(',')).join(';');const url=\"https://router.project-osrm.org/route/v1/driving/\".concat(coordStr,\"?overview=full&geometries=geojson\");try{const res=await fetch(url);const data=await res.json();if(data.routes&&data.routes[0]){const routeCoords=data.routes[0].geometry.coordinates.map(_ref2=>{let[lon,lat]=_ref2;return[lat,lon];});setRotaPolyline(routeCoords);// Mesafe ve süreyi state'e yaz\nsetRotaOzet({mesafe:data.routes[0].distance,sure:data.routes[0].duration});}else{setRotaPolyline([]);setRotaOzet(null);alert('Rota bulunamadı!');}}catch(_unused4){setRotaPolyline([]);setRotaOzet(null);alert('Rota oluşturulurken hata oluştu!');}setRotaLoading(false);};// Rota temizle\nconst handleRotaTemizle=()=>{setRotaPolyline([]);setRotaKaynakIds([]);setRotaOzet(null);};// En kısa rota (optimize) fonksiyonu\nconst handleEnKisaRota=async()=>{if(!myPosition){alert('Anlık konum alınamadı!');return;}if(rotaKaynakIds.length<2){alert('En az 2 kaynak seçmelisiniz!');return;}// id eşleşmesini hem string hem number olarak yap\nconst selected=rotaFilteredResources.filter(r=>rotaKaynakIds.includes(r.id)||rotaKaynakIds.includes(String(r.id)));if(selected.length<2){alert('Seçili kaynaklar bulunamadı!');return;}// Başlangıç noktası olarak anlık konum ekle\nconst coords=[[myPosition[1],myPosition[0]],...selected.map(r=>[parseFloat(r.lng),parseFloat(r.lat)])];if(coords.some(c=>isNaN(c[0])||isNaN(c[1]))){alert('Seçili kaynaklardan birinin koordinatı eksik veya hatalı!');return;}const coordStr=coords.map(c=>c.join(',')).join(';');const url=\"https://router.project-osrm.org/trip/v1/driving/\".concat(coordStr,\"?source=first&roundtrip=false&overview=full&geometries=geojson\");try{const res=await fetch(url);const data=await res.json();if(data.trips&&data.trips[0]&&data.waypoints){// Yeni sıralamayı bul\n// İlk nokta (anlık konum) sabit, diğerleri optimize edilmiş\nconst newOrder=data.waypoints.slice(1).sort((a,b)=>a.waypoint_index-b.waypoint_index);const newIds=newOrder.map(wp=>{// Koordinat eşleşmesi ile id bul\nconst[lng,lat]=wp.location;const found=selected.find(r=>Math.abs(parseFloat(r.lat)-lat)<1e-5&&Math.abs(parseFloat(r.lng)-lng)<1e-5);return found?found.id:null;}).filter(Boolean);setRotaKaynakIds(newIds);// Rota çizgisi ve özet\nconst routeCoords=data.trips[0].geometry.coordinates.map(_ref3=>{let[lon,lat]=_ref3;return[lat,lon];});setRotaPolyline(routeCoords);setRotaOzet({mesafe:data.trips[0].distance,sure:data.trips[0].duration});}else{alert('En kısa rota bulunamadı!');}}catch(_unused5){alert('En kısa rota oluşturulurken hata oluştu!');}};// Ana return bloğunu ve içerikleri tek bir kapsayıcı ile sarıyorum, eksik kapanışları tamamlıyorum\nreturn/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',bgcolor:'#f4f6fa',pb:4},children:/*#__PURE__*/_jsxs(Box,{sx:{maxWidth:900,mx:'auto',mt:4,mb:2,p:{xs:1,sm:2},background:'#fff',borderRadius:3,boxShadow:3},children:[/*#__PURE__*/_jsx(Box,{sx:{maxWidth:800,mx:'auto',mb:2,display:'flex',justifyContent:'flex-end'},children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(FilterListIcon,{}),onClick:()=>setFilterOpen(true),children:\"Filtrele\"})}),/*#__PURE__*/_jsx(Drawer,{anchor:\"left\",open:filterOpen,onClose:()=>setFilterOpen(false),PaperProps:{sx:{width:{xs:'100vw',sm:380},maxWidth:'100vw',height:{xs:'100vh',sm:'auto'},borderRadius:{xs:0,sm:3},boxShadow:8,p:0,transition:'all 0.3s',display:'flex',flexDirection:'column',bgcolor:'#f8fafc'}},children:/*#__PURE__*/_jsxs(Box,{sx:{width:'100%',flex:1,display:'flex',flexDirection:'column',p:0,pt:0},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',py:2,px:2,borderBottom:'1px solid #e0e0e0',bgcolor:'#fff',position:'sticky',top:0,zIndex:10},children:[/*#__PURE__*/_jsx(FilterListIcon,{color:\"primary\",sx:{mr:1,fontSize:30}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontWeight:700,sx:{fontSize:22},children:\"Filtrele\"}),/*#__PURE__*/_jsx(IconButton,{sx:{ml:'auto',fontSize:30},onClick:()=>setFilterOpen(false),children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(Box,{sx:{flex:1,p:{xs:2,sm:3},pt:2,display:'flex',flexDirection:'column',gap:3},children:[/*#__PURE__*/_jsxs(TextField,{select:true,label:\"Kaynak Ad\\u0131\",value:filterType,onChange:e=>setFilterType(e.target.value),fullWidth:true,sx:{fontSize:18},size:\"medium\",InputLabelProps:{style:{fontSize:18}},InputProps:{style:{fontSize:18}},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"T\\xFCm\\xFC\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"sivrisinek\",children:\"Sivrisinek\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"karasinek\",children:\"Karasinek\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"cop\",children:\"\\xC7\\xF6p Konteyn\\u0131r\\u0131\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"logar\",children:\"Logar\"})]}),/*#__PURE__*/_jsxs(TextField,{select:true,label:\"\\u0130l\\xE7e\",value:filterIlce,onChange:e=>setFilterIlce(e.target.value),fullWidth:true,sx:{fontSize:18},size:\"medium\",InputLabelProps:{style:{fontSize:18}},InputProps:{style:{fontSize:18}},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"T\\xFCm\\xFC\"}),ilceler.map(ilce=>/*#__PURE__*/_jsx(MenuItem,{value:ilce,children:ilce},ilce))]}),/*#__PURE__*/_jsxs(TextField,{select:true,label:\"Mahalle\",value:filterMahalle,onChange:e=>setFilterMahalle(e.target.value),fullWidth:true,sx:{fontSize:18},size:\"medium\",InputLabelProps:{style:{fontSize:18}},InputProps:{style:{fontSize:18}},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"T\\xFCm\\xFC\"}),mahalleler.map(mahalle=>/*#__PURE__*/_jsx(MenuItem,{value:mahalle,children:mahalle},mahalle))]})]}),/*#__PURE__*/_jsxs(Box,{sx:{px:2,pb:2,pt:1,borderTop:'1px solid #e0e0e0',bgcolor:'#fff',position:'sticky',bottom:0,zIndex:10,display:'flex',gap:2},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",fullWidth:true,sx:{py:1.3,fontSize:17,fontWeight:600,borderRadius:2},onClick:()=>{setFilterType('');setFilterIlce('');setFilterMahalle('');},children:\"S\\u0131f\\u0131rla\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",fullWidth:true,sx:{py:1.3,fontSize:17,fontWeight:700,borderRadius:2},onClick:()=>setFilterOpen(false),children:\"Uygula\"})]})]})}),/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:{xs:1,sm:2},maxWidth:800,mx:'auto',mb:4},children:[selectedResourceIds.length>0&&/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'flex-end',mb:1,gap:2,flexDirection:{xs:'column',sm:'row'},alignItems:{xs:'stretch',sm:'center'}},children:[/*#__PURE__*/_jsxs(Typography,{color:\"primary\",fontWeight:700,sx:{fontSize:{xs:16,sm:18}},children:[selectedResourceIds.length,\" kaynak se\\xE7ildi\"]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",size:\"large\",sx:{fontSize:{xs:16,sm:14},py:{xs:1.2,sm:0.5}},onClick:handleBulkIlacla,children:\"Toplu \\u0130la\\xE7la\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"error\",size:\"large\",sx:{fontSize:{xs:16,sm:14},py:{xs:1.2,sm:0.5}},onClick:handleClearSelection,children:\"Se\\xE7imi Temizle\"})]}),/*#__PURE__*/_jsx(Box,{sx:{width:'100%',height:{xs:'calc(100vh - 56px)',sm:500},borderRadius:{xs:0,sm:2},overflow:'hidden',mb:1,mt:1,position:'relative',boxShadow:3},children:/*#__PURE__*/_jsxs(MapContainer,{center:center,zoom:8,style:{width:'100%',height:'100%'},ref:mapRef,children:[/*#__PURE__*/_jsxs(LayersControl,{position:\"topright\",children:[/*#__PURE__*/_jsx(LayersControl.BaseLayer,{checked:true,name:\"Sokak Haritas\\u0131 (OSM)\",children:/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 OpenStreetMap contributors\",url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"})}),/*#__PURE__*/_jsx(LayersControl.BaseLayer,{name:\"Uydu (Esri)\",children:/*#__PURE__*/_jsx(TileLayer,{attribution:\"Tiles \\xA9 Esri \\u2014 Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community\",url:\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"})}),/*#__PURE__*/_jsx(LayersControl.BaseLayer,{name:\"Topo\\u011Frafya (OpenTopoMap)\",children:/*#__PURE__*/_jsx(TileLayer,{attribution:\"Map data: \\xA9 OpenTopoMap (CC-BY-SA)\",url:\"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png\"})}),/*#__PURE__*/_jsx(LayersControl.Overlay,{checked:true,name:\"\\u0130\\u015Faretler\",children:/*#__PURE__*/_jsx(LayerGroup,{children:markers.map((marker,idx)=>/*#__PURE__*/_jsx(Marker,{position:[marker.lat,marker.lng]},marker.id||idx))})}),/*#__PURE__*/_jsx(LayersControl.Overlay,{checked:true,name:\"Kaynaklar\",children:/*#__PURE__*/_jsx(LayerGroup,{children:/*#__PURE__*/_jsxs(MarkerClusterGroup,{children:[rotaFilteredResources.map((res,idx)=>{const isRotaSelected=rotaKaynakIds.includes(res.id);if(!isRotaSelected)return null;// Sıra numarasını bul\nconst order=rotaKaynakIds.indexOf(res.id);return/*#__PURE__*/_jsx(Marker,{position:[parseFloat(res.lat),parseFloat(res.lng)],icon:L.divIcon({html:\"<div style='position:relative;display:flex;align-items:center;justify-content:center;'>\\n                                <img src='https://cdn-icons-png.flaticon.com/512/684/684908.png' style='width:36px;height:36px;'/>\\n                                <div style='position:absolute;top:-8px;right:-8px;background:#1976d2;color:white;font-size:14px;font-weight:bold;border-radius:50%;width:22px;height:22px;display:flex;align-items:center;justify-content:center;border:2px solid #fff;'>\".concat(order+1,\"</div>\\n                              </div>\")}),children:/*#__PURE__*/_jsxs(Tooltip,{children:[\"Rota Noktas\\u0131 #\",order+1]})},\"rota-\".concat(res.id));}),filteredResources.map((res,idx)=>{var _res$type,_res$type2;// Kalan süreyi hesapla (saniye cinsinden)\nlet kalanSn=null;if(res.ilaclandiMi&&res.ilaclamaZamani){const sure=ilaclanmaSureleri[res.type]||{gun:15,saat:0,dakika:0};const gun=Number(sure.gun)||0;const saat=Number(sure.saat)||0;const dakika=Number(sure.dakika)||0;const ILACLAMA_SURESI=gun*24*60*60+saat*60*60+dakika*60;const start=new Date(res.ilaclamaZamani).getTime();const now=Date.now();const diff=Math.floor((now-start)/1000);kalanSn=ILACLAMA_SURESI-diff;}// Her zaman kendi iconu gösterilecek\nlet iconUrl=resourceTypeIcons[res.type]||resourceTypeIcons['sivrisinek'];let tooltipText=res.type;const isSelected=selectedResourceIds.includes(res.id);const isSearched=searchMatchedId===res.id;return/*#__PURE__*/_jsxs(Marker,{position:[parseFloat(res.lat),parseFloat(res.lng)],icon:L.icon({iconUrl,iconSize:isSearched?[44,44]:isSelected?[38,38]:[28,28],iconAnchor:[isSearched?22:isSelected?19:14,isSearched?44:isSelected?38:28],popupAnchor:[0,-28],className:isSearched?'searched-marker':isSelected?'selected-marker':''}),eventHandlers:{click:()=>handleSelectResource(res.id)},children:[/*#__PURE__*/_jsx(Popup,{minWidth:260,maxWidth:420,children:/*#__PURE__*/_jsxs(Box,{sx:{p:{xs:1.5,sm:2},minWidth:{xs:'90vw',sm:260},maxWidth:{xs:'98vw',sm:420},borderRadius:3,boxShadow:6,bgcolor:'#fff',display:'flex',flexDirection:'column',gap:1.2,'@media (max-width:600px)':{minWidth:'98vw',maxWidth:'99vw',px:2,py:2,borderRadius:0}},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1,mb:1},children:[/*#__PURE__*/_jsx(Avatar,{src:resourceTypeIcons[res.type]||'',sx:{width:38,height:38,bgcolor:'#e3f2fd'}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"primary\",fontWeight:700,sx:{fontSize:{xs:18,sm:20}},children:((_res$type=res.type)===null||_res$type===void 0?void 0:_res$type.charAt(0).toUpperCase())+((_res$type2=res.type)===null||_res$type2===void 0?void 0:_res$type2.slice(1))})]}),res.adres&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Adres:\"}),\" \",res.adres]}),res.ilce&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"\\u0130l\\xE7e:\"}),\" \",res.ilce]}),res.mahalle&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Mahalle:\"}),\" \",res.mahalle]}),res.aciklama&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"A\\xE7\\u0131klama:\"}),\" \",res.aciklama]}),res.tarih&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Tarih:\"}),\" \",res.tarih]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:1},children:[/*#__PURE__*/_jsx(\"b\",{children:\"Son \\u0130la\\xE7lama:\"}),\" \",res.ilaclamaZamani?new Date(res.ilaclamaZamani).toLocaleString('tr-TR'):'-']}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Kalan S\\xFCre:\"}),\" \",kalanSure(res)]}),res.resim&&/*#__PURE__*/_jsx(Box,{sx:{mt:1,mb:1,textAlign:'center'},children:/*#__PURE__*/_jsx(\"img\",{src:res.resim,alt:\"Kaynak\",style:{width:100,height:100,objectFit:'cover',borderRadius:10,border:'1px solid #eee'}})}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",size:\"large\",fullWidth:true,sx:{mt:1,fontSize:{xs:17,sm:15},py:{xs:1.3,sm:0.7},borderRadius:2},onClick:()=>handleIlacla(res),children:\"\\u0130la\\xE7land\\u0131 Olarak \\u0130\\u015Faretle\"})]})}),/*#__PURE__*/_jsx(Tooltip,{children:tooltipText})]},res.id||idx);})]})})}),rotaPolyline.length>1&&/*#__PURE__*/_jsx(Polyline,{positions:rotaPolyline,pathOptions:{color:'blue',weight:5,opacity:0.8}}),myPosition&&/*#__PURE__*/_jsx(LayersControl.Overlay,{checked:true,name:\"Kendi Konumunuz\",children:/*#__PURE__*/_jsx(LayerGroup,{children:/*#__PURE__*/_jsx(Circle,{center:myPosition,radius:15,pathOptions:{color:'#1976d2',fillColor:'#1976d2',fillOpacity:0.2},children:/*#__PURE__*/_jsx(Tooltip,{children:\"Kendi Konumunuz\"})})})})]}),/*#__PURE__*/_jsx(GoToMyLocation,{position:myPosition})]})})]}),/*#__PURE__*/_jsx(Box,{sx:{maxWidth:800,mx:'auto',mb:2,mt:1,px:{xs:1,sm:0},display:'flex',justifyContent:'flex-end'},children:/*#__PURE__*/_jsxs(Box,{sx:{bgcolor:'rgba(255,255,255,0.92)',boxShadow:3,borderRadius:2,px:2,py:1,minWidth:160,fontSize:15,display:'flex',flexDirection:'column',gap:0.5,'@media (max-width:600px)':{minWidth:0,px:1,py:0.5,fontSize:13}},children:[/*#__PURE__*/_jsx(Typography,{fontWeight:700,color:\"primary\",sx:{fontSize:{xs:15,sm:16}},children:\"\\u0130statistikler\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Toplam:\"}),/*#__PURE__*/_jsx(\"b\",{children:toplamKaynak})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',color:'#43ea6d'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Aktif:\"}),/*#__PURE__*/_jsx(\"b\",{children:aktifKaynak})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',color:'#ff9800'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Kritik:\"}),/*#__PURE__*/_jsx(\"b\",{children:kritikKaynak})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',color:'#ff5e5e'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"S\\xFCresi Dolan:\"}),/*#__PURE__*/_jsx(\"b\",{children:dolanKaynak})]})]})}),/*#__PURE__*/_jsxs(Box,{sx:{maxWidth:800,mx:'auto',mb:2,mt:2,p:2,background:'#f8fafc',borderRadius:2,border:'1px solid #e0e0e0',boxShadow:2,'@media (max-width:600px)':{p:1,borderRadius:1}},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"primary\",fontWeight:700,sx:{mb:2,fontSize:{xs:18,sm:22}},children:\"Kaynak Rota Planlay\\u0131c\\u0131\"}),rotaKaynakIds.length>0&&/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{fontWeight:600,sx:{mb:1,fontSize:{xs:15,sm:16}},children:\"Rota S\\u0131ras\\u0131:\"}),/*#__PURE__*/_jsx(List,{dense:true,sx:{bgcolor:'#fff',borderRadius:1,boxShadow:1,p:0},children:rotaKaynakIds.map((id,idx)=>{const r=rotaFilteredResources.find(x=>x.id===id);if(!r)return null;return/*#__PURE__*/_jsx(ListItem,{secondaryAction:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:{xs:0.5,sm:1}},children:[/*#__PURE__*/_jsx(IconButton,{size:\"medium\",disabled:idx===0,onClick:()=>{if(idx===0)return;const newIds=[...rotaKaynakIds];[newIds[idx-1],newIds[idx]]=[newIds[idx],newIds[idx-1]];setRotaKaynakIds(newIds);},sx:{fontSize:{xs:22,sm:18}},children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:22},children:\"\\u2191\"})}),/*#__PURE__*/_jsx(IconButton,{size:\"medium\",disabled:idx===rotaKaynakIds.length-1,onClick:()=>{if(idx===rotaKaynakIds.length-1)return;const newIds=[...rotaKaynakIds];[newIds[idx+1],newIds[idx]]=[newIds[idx],newIds[idx+1]];setRotaKaynakIds(newIds);},sx:{fontSize:{xs:22,sm:18}},children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:22},children:\"\\u2193\"})}),/*#__PURE__*/_jsx(IconButton,{size:\"medium\",onClick:()=>{if(mapRef.current&&r.lat&&r.lng){mapRef.current.setView([parseFloat(r.lat),parseFloat(r.lng)],16);}},title:\"Haritada G\\xF6ster\",sx:{fontSize:{xs:22,sm:18}},children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:22},children:\"\\uD83D\\uDCCD\"})}),/*#__PURE__*/_jsx(IconButton,{size:\"medium\",color:\"error\",onClick:()=>{setRotaKaynakIds(rotaKaynakIds.filter(x=>x!==id));},title:\"Listeden \\xC7\\u0131kar\",sx:{fontSize:{xs:22,sm:18}},children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:22},children:\"\\u2715\"})})]}),children:/*#__PURE__*/_jsx(ListItemText,{primary:\"\".concat(idx+1,\". \").concat(r.type,\" - \").concat(r.ilce,\" / \").concat(r.mahalle),sx:{fontSize:{xs:15,sm:16}}})},id);})}),rotaOzet&&/*#__PURE__*/_jsxs(Box,{sx:{mt:2,p:1,bgcolor:'#e3f2fd',borderRadius:1,display:'flex',gap:3,fontWeight:600,fontSize:{xs:14,sm:15},flexDirection:{xs:'column',sm:'row'}},children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Toplam Mesafe: \",(rotaOzet.mesafe/1000).toFixed(2),\" km\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Tahmini S\\xFCre: \",(rotaOzet.sure/60).toFixed(0),\" dk\"]})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexWrap:'wrap',gap:2,mb:2,flexDirection:{xs:'column',sm:'row'}},children:[/*#__PURE__*/_jsxs(TextField,{select:true,label:\"Kaynak T\\xFCr\\xFC\",value:rotaType,onChange:e=>setRotaType(e.target.value),size:\"small\",sx:{minWidth:160},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"T\\xFCm\\xFC\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"sivrisinek\",children:\"Sivrisinek\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"karasinek\",children:\"Karasinek\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"cop\",children:\"\\xC7\\xF6p Konteyn\\u0131r\\u0131\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"logar\",children:\"Logar\"})]}),/*#__PURE__*/_jsxs(TextField,{select:true,label:\"\\u0130l\\xE7e\",value:rotaIlce,onChange:e=>setRotaIlce(e.target.value),size:\"small\",sx:{minWidth:160},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"T\\xFCm\\xFC\"}),ilceler.map(ilce=>/*#__PURE__*/_jsx(MenuItem,{value:ilce,children:ilce},ilce))]}),/*#__PURE__*/_jsxs(TextField,{select:true,label:\"Mahalle\",value:rotaMahalle,onChange:e=>setRotaMahalle(e.target.value),size:\"small\",sx:{minWidth:160},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"T\\xFCm\\xFC\"}),mahalleler.map(mahalle=>/*#__PURE__*/_jsx(MenuItem,{value:mahalle,children:mahalle},mahalle))]}),/*#__PURE__*/_jsx(TextField,{select:true,label:\"Kaynak Ad\\u0131\",value:rotaKaynakIds,onChange:e=>setRotaKaynakIds(typeof e.target.value==='string'?e.target.value.split(','):e.target.value),size:\"small\",sx:{minWidth:200,flex:1},SelectProps:{multiple:true,renderValue:selected=>selected.map(id=>{const r=rotaFilteredResources.find(x=>x.id===id);return r?\"\".concat(r.type,\" - \").concat(r.ilce,\" / \").concat(r.mahalle):id;}).join(', ')},children:rotaFilteredResources.map(r=>/*#__PURE__*/_jsxs(MenuItem,{value:r.id,children:[r.type,\" - \",r.ilce,\" / \",r.mahalle]},r.id))})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2},children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",disabled:rotaKaynakIds.length<2||rotaLoading,onClick:handleRotaOlustur,sx:{width:{xs:'100%',sm:'auto'},fontSize:{xs:16,sm:15},py:{xs:1.2,sm:0.5}},children:rotaLoading?'Rota Oluşturuluyor...':'Rota Oluştur'}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",onClick:handleRotaTemizle,disabled:rotaPolyline.length===0&&rotaKaynakIds.length===0,sx:{width:{xs:'100%',sm:'auto'},fontSize:{xs:16,sm:15},py:{xs:1.2,sm:0.5}},children:\"Temizle\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",disabled:rotaKaynakIds.length<2,onClick:handleEnKisaRota,sx:{width:{xs:'100%',sm:'auto'},fontSize:{xs:16,sm:15},py:{xs:1.2,sm:0.5}},children:\"En K\\u0131sa Rota\"})]})]})]})});};export default MapPage;","map":{"version":3,"names":["React","useState","useEffect","useRef","Box","Typography","Paper","List","ListItem","ListItemText","TextField","Button","Drawer","IconButton","Avatar","MapContainer","TileLayer","Marker","Tooltip","useMap","Circle","Popup","LayersControl","LayerGroup","Polyline","L","MyLocationIcon","FilterListIcon","MenuItem","MarkerClusterGroup","jsx","_jsx","jsxs","_jsxs","API_URL","RESOURCES_API","iconUrl","require","iconShadow","defaultIcon","icon","shadowUrl","iconAnchor","prototype","options","center","resourceTypeIcons","sivrisinek","karasinek","cop","logar","criticalIconUrl","expiredIconUrl","MapPage","markers","setMarkers","resources","setResources","error","setError","desc","setDesc","pendingLatLng","setPendingLatLng","loading","setLoading","myPosition","setMyPosition","filterOpen","setFilterOpen","filterType","setFilterType","filterIlce","setFilterIlce","filterMahalle","setFilterMahalle","selectedResourceIds","setSelectedResourceIds","searchText","setSearchText","searchMatchedId","setSearchMatchedId","rotaKaynakIds","setRotaKaynakIds","rotaType","setRotaType","rotaIlce","setRotaIlce","rotaMahalle","setRotaMahalle","rotaPolyline","setRotaPolyline","rotaLoading","setRotaLoading","rotaOzet","setRotaOzet","mapRef","ilceler","mahalleler","sort","a","b","localeCompare","filteredResources","filter","res","type","ilce","mahalle","rotaFilteredResources","found","find","toLowerCase","includes","adres","current","id","setView","parseFloat","lat","lng","watchId","navigator","geolocation","watchPosition","pos","coords","latitude","longitude","undefined","enableHighAccuracy","maximumAge","timeout","clearWatch","fetch","then","json","data","catch","handleAddMarker","handleSubmit","e","preventDefault","method","headers","body","JSON","stringify","ok","prev","_unused","GoToMyLocation","_ref","position","map","sx","bottom","xs","md","right","zIndex","display","flexDirection","alignItems","children","color","size","bgcolor","boxShadow","width","sm","height","borderRadius","border","opacity","pointerEvents","onClick","disabled","fontSize","defaultSureler","gun","saat","dakika","ilaclanmaSureleri","stored","localStorage","getItem","parse","_unused2","kalanSure","ilaclandiMi","ilaclamaZamani","sure","Number","ILACLAMA_SURESI","start","Date","getTime","now","diff","Math","floor","kalanSn","isFinite","isNaN","kalanGun","kalanSaat","kalanDk","concat","handleIlacla","toISOString","_unused3","handleSelectResource","i","handleBulkIlacla","Promise","all","handleClearSelection","toplamKaynak","length","aktifKaynak","kritikKaynak","dolanKaynak","forEach","handleRotaOlustur","alert","selected","r","String","some","c","coordStr","join","url","routes","routeCoords","geometry","coordinates","_ref2","lon","mesafe","distance","duration","_unused4","handleRotaTemizle","handleEnKisaRota","trips","waypoints","newOrder","slice","waypoint_index","newIds","wp","location","abs","Boolean","_ref3","_unused5","minHeight","pb","maxWidth","mx","mt","mb","p","background","justifyContent","variant","startIcon","anchor","open","onClose","PaperProps","transition","flex","pt","py","px","borderBottom","top","mr","fontWeight","ml","gap","select","label","value","onChange","target","fullWidth","InputLabelProps","style","InputProps","borderTop","elevation","overflow","zoom","ref","BaseLayer","checked","name","attribution","Overlay","marker","idx","isRotaSelected","order","indexOf","divIcon","html","_res$type","_res$type2","tooltipText","isSelected","isSearched","iconSize","popupAnchor","className","eventHandlers","click","minWidth","src","charAt","toUpperCase","aciklama","tarih","toLocaleString","resim","textAlign","alt","objectFit","positions","pathOptions","weight","radius","fillColor","fillOpacity","dense","x","secondaryAction","title","primary","toFixed","flexWrap","split","SelectProps","multiple","renderValue"],"sources":["C:/Users/MUSTAFA/cursorprojects/balyailaclama/frontend/src/MapPage.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { Box, Typography, Paper, List, ListItem, ListItemText, TextField, Button, Drawer, IconButton, Badge, ListItemButton, Avatar, useTheme } from '@mui/material';\r\nimport { MapContainer, TileLayer, Marker, Tooltip, useMap, Circle, Popup, LayersControl, LayerGroup, Polyline } from 'react-leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport L from 'leaflet';\r\nimport MyLocationIcon from '@mui/icons-material/MyLocation';\r\nimport FilterListIcon from '@mui/icons-material/FilterList';\r\nimport MenuItem from '@mui/material/MenuItem';\r\n// @ts-ignore\r\nimport MarkerClusterGroup from 'react-leaflet-cluster';\r\nimport InventoryIcon from '@mui/icons-material/Inventory';\r\nimport ScienceIcon from '@mui/icons-material/Science';\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\nimport HomeIcon from '@mui/icons-material/Home';\r\nimport MapIcon from '@mui/icons-material/Map';\r\n\r\nconst API_URL = 'http://localhost:4000/api/markers';\r\nconst RESOURCES_API = 'http://localhost:4000/api/resources';\r\n\r\n// Varsayılan marker ikonunu düzeltmek için\r\nconst iconUrl = require('leaflet/dist/images/marker-icon.png');\r\nconst iconShadow = require('leaflet/dist/images/marker-shadow.png');\r\n\r\nconst defaultIcon = L.icon({\r\n  iconUrl,\r\n  shadowUrl: iconShadow,\r\n  iconAnchor: [12, 41],\r\n});\r\nL.Marker.prototype.options.icon = defaultIcon;\r\n\r\nconst center: [number, number] = [39.9208, 32.8541]; // Ankara merkez\r\n\r\nconst resourceTypeIcons: { [key: string]: string } = {\r\n  sivrisinek: 'https://cdn-icons-png.flaticon.com/512/17275/17275339.png',\r\n  karasinek: 'https://cdn-icons-png.flaticon.com/512/12311/12311394.png',\r\n  cop: 'https://cdn-icons-png.flaticon.com/512/7657/7657533.png',\r\n  logar: 'https://cdn-icons-png.flaticon.com/512/4357/4357706.png',\r\n};\r\nconst criticalIconUrl = 'https://cdn-icons-png.flaticon.com/512/564/564619.png'; // turuncu\r\nconst expiredIconUrl = 'https://cdn-icons-png.flaticon.com/512/564/564623.png'; // kırmızı\r\n\r\nconst MapPage: React.FC = () => {\r\n  const [markers, setMarkers] = useState<any[]>([]);\r\n  const [resources, setResources] = useState<any[]>([]);\r\n  const [error, setError] = useState('');\r\n  const [desc, setDesc] = useState('');\r\n  const [pendingLatLng, setPendingLatLng] = useState<{ lat: number; lng: number } | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [myPosition, setMyPosition] = useState<[number, number] | null>(null);\r\n  const [filterOpen, setFilterOpen] = useState(false);\r\n  const [filterType, setFilterType] = useState('');\r\n  const [filterIlce, setFilterIlce] = useState('');\r\n  const [filterMahalle, setFilterMahalle] = useState('');\r\n  const [selectedResourceIds, setSelectedResourceIds] = useState<string[]>([]);\r\n  const [searchText, setSearchText] = useState('');\r\n  const [searchMatchedId, setSearchMatchedId] = useState<string | null>(null);\r\n  const [rotaKaynakIds, setRotaKaynakIds] = useState<string[]>([]);\r\n  const [rotaType, setRotaType] = useState('');\r\n  const [rotaIlce, setRotaIlce] = useState('');\r\n  const [rotaMahalle, setRotaMahalle] = useState('');\r\n  const [rotaPolyline, setRotaPolyline] = useState<[number, number][]>([]);\r\n  const [rotaLoading, setRotaLoading] = useState(false);\r\n  const [rotaOzet, setRotaOzet] = useState<{ mesafe: number; sure: number } | null>(null);\r\n  const mapRef = useRef<any>(null);\r\n\r\n  // İlçe ve mahalleler (örnek, gerekirse dışarıdan alınabilir)\r\n  const ilceler = [\r\n    'Altıeylül', 'Ayvalık', 'Balya', 'Bandırma', 'Bigadiç', 'Burhaniye', 'Dursunbey',\r\n    'Edremit', 'Erdek', 'Gömeç', 'Gönen', 'Havran', 'İvrindi', 'Karesi', 'Kepsut',\r\n    'Manyas', 'Marmara', 'Savaştepe', 'Sındırgı', 'Susurluk'\r\n  ];\r\n  const mahalleler = [\r\n    'KADİKÖY', 'KAVAK ALANI', 'GÖKMUSA', 'SÖBÜCEALAN', 'KARLIK', 'ILICA', 'YENİKAVAK', 'YARIŞALALANI', 'KARACAHİSAR', 'KAYALAR',\r\n    'SEMİZKÖY', 'ÖREN', 'DANIŞMENT', 'GÖLOBA', 'KOYUNERİ', 'ORHANLAR', 'DEĞİRMENDERE', 'MANCILIK', 'DEREKÖY', 'KARAMUSTAFALAR',\r\n    'ÇALOVA', 'YAZLIK', 'ÇUKURCAK', 'KAYAPINAR',\r\n    'MÜSTECAP', 'BENGİLER', 'ÇİĞDEM', 'ÇAMAVŞAR', 'ÇAMUCU', 'FARSAK', 'ÇARMIK', 'YAYLACIK', 'HAVUTBAŞI', 'DOĞANLAR',\r\n    'ÇAKALLAR', 'YUKARI ÇAKALLAR', 'KAŞIKÇI', 'HABİPLER', 'GÖKTEPE', 'AKBAŞ', 'KOCABÜK', 'MEDRESE', 'HACIHÜSEYİN', 'NARLI',\r\n    'ALİDEMİRCİ', 'AKÇAL', 'PATLAK',\r\n    'KOCACAMİ', 'ENVERPAŞA'\r\n  ].sort((a, b) => a.localeCompare(b, 'tr'));\r\n\r\n  // Filtreye uyan kaynaklar\r\n  const filteredResources = resources.filter(res => {\r\n    if (filterType && res.type !== filterType) return false;\r\n    if (filterIlce && res.ilce !== filterIlce) return false;\r\n    if (filterMahalle && res.mahalle !== filterMahalle) return false;\r\n    return true;\r\n  });\r\n\r\n  // Rota için filtrelenmiş kaynaklar\r\n  const rotaFilteredResources = resources.filter(res => {\r\n    if (rotaType && res.type !== rotaType) return false;\r\n    if (rotaIlce && res.ilce !== rotaIlce) return false;\r\n    if (rotaMahalle && res.mahalle !== rotaMahalle) return false;\r\n    return true;\r\n  });\r\n\r\n  // Arama işlemi\r\n  useEffect(() => {\r\n    if (!searchText) {\r\n      setSearchMatchedId(null);\r\n      return;\r\n    }\r\n    const found = filteredResources.find(res =>\r\n      (res.type && res.type.toLowerCase().includes(searchText.toLowerCase())) ||\r\n      (res.mahalle && res.mahalle.toLowerCase().includes(searchText.toLowerCase())) ||\r\n      (res.adres && res.adres.toLowerCase().includes(searchText.toLowerCase()))\r\n    );\r\n    if (found && mapRef.current) {\r\n      setSearchMatchedId(found.id);\r\n      mapRef.current.setView([parseFloat(found.lat), parseFloat(found.lng)], 15);\r\n    } else {\r\n      setSearchMatchedId(null);\r\n    }\r\n  }, [searchText]);\r\n\r\n  // Canlı konumu al\r\n  useEffect(() => {\r\n    let watchId: number | null = null;\r\n    if (navigator.geolocation) {\r\n      watchId = navigator.geolocation.watchPosition(\r\n        pos => setMyPosition([pos.coords.latitude, pos.coords.longitude]),\r\n        undefined,\r\n        { enableHighAccuracy: true, maximumAge: 10000, timeout: 20000 }\r\n      );\r\n    }\r\n    return () => {\r\n      if (watchId !== null && navigator.geolocation) {\r\n        navigator.geolocation.clearWatch(watchId);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Hem işaretleri hem kaynakları çek\r\n  useEffect(() => {\r\n    fetch(API_URL)\r\n      .then(res => res.json())\r\n      .then(data => setMarkers(data))\r\n      .catch(() => setError('İşaretler alınamadı!'));\r\n    fetch(RESOURCES_API)\r\n      .then(res => res.json())\r\n      .then(data => setResources(data))\r\n      .catch(() => setError('Kaynaklar alınamadı!'));\r\n  }, []);\r\n\r\n  // Haritaya tıklanınca açıklama formunu aç\r\n  const handleAddMarker = (lat: number, lng: number) => {\r\n    setPendingLatLng({ lat, lng });\r\n  };\r\n\r\n  // Formdan işareti ekle\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!pendingLatLng) return;\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch(API_URL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ lat: pendingLatLng.lat, lng: pendingLatLng.lng, desc })\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok) {\r\n        setMarkers(prev => [...prev, data]);\r\n        setDesc('');\r\n        setPendingLatLng(null);\r\n      } else {\r\n        setError(data.error || 'İşaret eklenemedi!');\r\n      }\r\n    } catch {\r\n      setError('Sunucuya ulaşılamıyor!');\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  // Konumuma git butonu\r\n  function GoToMyLocation({ position }: { position: [number, number] | null }) {\r\n    const map = useMap();\r\n    return (\r\n      <Box\r\n        sx={{\r\n          position: 'absolute',\r\n          bottom: { xs: 16, md: 24 },\r\n          right: { xs: 16, md: 24 },\r\n          zIndex: 1200,\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'flex-end',\r\n        }}\r\n      >\r\n        <IconButton\r\n          color=\"primary\"\r\n          size=\"large\"\r\n          sx={{\r\n            bgcolor: 'white',\r\n            boxShadow: 3,\r\n            width: { xs: 64, sm: 56 },\r\n            height: { xs: 64, sm: 56 },\r\n            borderRadius: '50%',\r\n            border: '2px solid #1976d2',\r\n            '&:hover': { bgcolor: '#e3f2fd' },\r\n            opacity: position ? 1 : 0.5,\r\n            pointerEvents: position ? 'auto' : 'none',\r\n          }}\r\n          onClick={() => {\r\n            if (position) map.setView(position, 15);\r\n          }}\r\n          disabled={!position}\r\n        >\r\n          <MyLocationIcon sx={{ fontSize: { xs: 38, sm: 32 }, color: '#1976d2' }} />\r\n        </IconButton>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  // localStorage'dan ilaçlanma sürelerini oku\r\n  const defaultSureler = { sivrisinek: { gun: 15, saat: 0, dakika: 0 }, karasinek: { gun: 15, saat: 0, dakika: 0 }, cop: { gun: 20, saat: 0, dakika: 0 }, logar: { gun: 10, saat: 0, dakika: 0 } };\r\n  let ilaclanmaSureleri: Record<string, { gun: number; saat: number; dakika: number }> = defaultSureler;\r\n  try {\r\n    const stored = localStorage.getItem('ilaclamaSureleri');\r\n    if (stored) ilaclanmaSureleri = JSON.parse(stored);\r\n  } catch {}\r\n\r\n  // Kalan süre hesaplama fonksiyonu (örnek: 15 gün)\r\n  function kalanSure(res: any) {\r\n    if (!res.ilaclandiMi || !res.ilaclamaZamani) return '-';\r\n    const sure = ilaclanmaSureleri[res.type] || { gun: 15, saat: 0, dakika: 0 };\r\n    const gun = Number(sure.gun) || 0;\r\n    const saat = Number(sure.saat) || 0;\r\n    const dakika = Number(sure.dakika) || 0;\r\n    const ILACLAMA_SURESI = (gun * 24 * 60 * 60) + (saat * 60 * 60) + (dakika * 60);\r\n    const start = new Date(res.ilaclamaZamani).getTime();\r\n    const now = Date.now();\r\n    const diff = Math.floor((now - start) / 1000);\r\n    let kalanSn = ILACLAMA_SURESI - diff;\r\n    if (!isFinite(kalanSn) || isNaN(kalanSn) || kalanSn <= 0) return 'Süresi Doldu';\r\n    const kalanGun = Math.floor(kalanSn / (24 * 60 * 60));\r\n    const kalanSaat = Math.floor((kalanSn % (24 * 60 * 60)) / 3600);\r\n    const kalanDk = Math.floor((kalanSn % 3600) / 60);\r\n    return `Kalan Süre: ${kalanGun}g ${kalanSaat}s ${kalanDk}dk`;\r\n  }\r\n\r\n  // Hızlı ilaçla fonksiyonu\r\n  const handleIlacla = async (res: any) => {\r\n    if (!res.id) return;\r\n    const now = new Date().toISOString();\r\n    try {\r\n      await fetch(`${RESOURCES_API}/${res.id}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ ilaclamaZamani: now, ilaclandiMi: true })\r\n      });\r\n      // Kaynakları güncelle\r\n      fetch(RESOURCES_API)\r\n        .then(res => res.json())\r\n        .then(data => setResources(data));\r\n    } catch {}\r\n  };\r\n\r\n  // Marker seçme/çıkarma\r\n  const handleSelectResource = (id: string) => {\r\n    setSelectedResourceIds(prev => prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]);\r\n  };\r\n\r\n  // Toplu ilaçla\r\n  const handleBulkIlacla = async () => {\r\n    const now = new Date().toISOString();\r\n    await Promise.all(selectedResourceIds.map(async id => {\r\n      await fetch(`${RESOURCES_API}/${id}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ ilaclamaZamani: now, ilaclandiMi: true })\r\n      });\r\n    }));\r\n    // Kaynakları güncelle\r\n    fetch(RESOURCES_API)\r\n      .then(res => res.json())\r\n      .then(data => setResources(data));\r\n    setSelectedResourceIds([]);\r\n  };\r\n\r\n  // Seçimi temizle\r\n  const handleClearSelection = () => setSelectedResourceIds([]);\r\n\r\n  // İstatistikler\r\n  const toplamKaynak = resources.length;\r\n  let aktifKaynak = 0, kritikKaynak = 0, dolanKaynak = 0;\r\n  resources.forEach(res => {\r\n    if (res.ilaclandiMi && res.ilaclamaZamani) {\r\n      const sure = ilaclanmaSureleri[res.type] || { gun: 15, saat: 0, dakika: 0 };\r\n      const gun = Number(sure.gun) || 0;\r\n      const saat = Number(sure.saat) || 0;\r\n      const dakika = Number(sure.dakika) || 0;\r\n      const ILACLAMA_SURESI = (gun * 24 * 60 * 60) + (saat * 60 * 60) + (dakika * 60);\r\n      const start = new Date(res.ilaclamaZamani).getTime();\r\n      const now = Date.now();\r\n      const diff = Math.floor((now - start) / 1000);\r\n      const kalanSn = ILACLAMA_SURESI - diff;\r\n      if (!isFinite(kalanSn) || isNaN(kalanSn) || kalanSn <= 0) dolanKaynak++;\r\n      else if (kalanSn < 3 * 24 * 60 * 60) kritikKaynak++;\r\n      else aktifKaynak++;\r\n    } else {\r\n      aktifKaynak++;\r\n    }\r\n  });\r\n\r\n  // Rota oluştur\r\n  const handleRotaOlustur = async () => {\r\n    if (!myPosition) {\r\n      alert('Anlık konum alınamadı! Lütfen konum izni verin veya konumunuzu açın.');\r\n      return;\r\n    }\r\n    if (rotaKaynakIds.length < 1) {\r\n      alert('En az 1 kaynak seçmelisiniz!');\r\n      return;\r\n    }\r\n    setRotaLoading(true);\r\n    // id eşleşmesini hem string hem number olarak yap\r\n    const selected = rotaFilteredResources.filter(r => rotaKaynakIds.includes(r.id) || rotaKaynakIds.includes(String(r.id)));\r\n    if (selected.length < 1) {\r\n      alert('Seçili kaynaklar bulunamadı!');\r\n      setRotaLoading(false);\r\n      return;\r\n    }\r\n    // Başlangıç noktası olarak anlık konum ekle\r\n    const coords = [[myPosition[1], myPosition[0]], ...selected.map(r => [parseFloat(r.lng), parseFloat(r.lat)])];\r\n    if (coords.some(c => isNaN(c[0]) || isNaN(c[1]))) {\r\n      alert('Seçili kaynaklardan birinin koordinatı eksik veya hatalı!');\r\n      setRotaLoading(false);\r\n      return;\r\n    }\r\n    const coordStr = coords.map(c => c.join(',')).join(';');\r\n    const url = `https://router.project-osrm.org/route/v1/driving/${coordStr}?overview=full&geometries=geojson`;\r\n    try {\r\n      const res = await fetch(url);\r\n      const data = await res.json();\r\n      if (data.routes && data.routes[0]) {\r\n        const routeCoords = data.routes[0].geometry.coordinates.map(\r\n          ([lon, lat]: [number, number]) => [lat, lon] as [number, number]\r\n        );\r\n        setRotaPolyline(routeCoords);\r\n        // Mesafe ve süreyi state'e yaz\r\n        setRotaOzet({\r\n          mesafe: data.routes[0].distance,\r\n          sure: data.routes[0].duration\r\n        });\r\n      } else {\r\n        setRotaPolyline([]);\r\n        setRotaOzet(null);\r\n        alert('Rota bulunamadı!');\r\n      }\r\n    } catch {\r\n      setRotaPolyline([]);\r\n      setRotaOzet(null);\r\n      alert('Rota oluşturulurken hata oluştu!');\r\n    }\r\n    setRotaLoading(false);\r\n  };\r\n\r\n  // Rota temizle\r\n  const handleRotaTemizle = () => {\r\n    setRotaPolyline([]);\r\n    setRotaKaynakIds([]);\r\n    setRotaOzet(null);\r\n  };\r\n\r\n  // En kısa rota (optimize) fonksiyonu\r\n  const handleEnKisaRota = async () => {\r\n    if (!myPosition) {\r\n      alert('Anlık konum alınamadı!');\r\n      return;\r\n    }\r\n    if (rotaKaynakIds.length < 2) {\r\n      alert('En az 2 kaynak seçmelisiniz!');\r\n      return;\r\n    }\r\n    // id eşleşmesini hem string hem number olarak yap\r\n    const selected = rotaFilteredResources.filter(r => rotaKaynakIds.includes(r.id) || rotaKaynakIds.includes(String(r.id)));\r\n    if (selected.length < 2) {\r\n      alert('Seçili kaynaklar bulunamadı!');\r\n      return;\r\n    }\r\n    // Başlangıç noktası olarak anlık konum ekle\r\n    const coords = [[myPosition[1], myPosition[0]], ...selected.map(r => [parseFloat(r.lng), parseFloat(r.lat)])];\r\n    if (coords.some(c => isNaN(c[0]) || isNaN(c[1]))) {\r\n      alert('Seçili kaynaklardan birinin koordinatı eksik veya hatalı!');\r\n      return;\r\n    }\r\n    const coordStr = coords.map(c => c.join(',')).join(';');\r\n    const url = `https://router.project-osrm.org/trip/v1/driving/${coordStr}?source=first&roundtrip=false&overview=full&geometries=geojson`;\r\n    try {\r\n      const res = await fetch(url);\r\n      const data = await res.json();\r\n      if (data.trips && data.trips[0] && data.waypoints) {\r\n        // Yeni sıralamayı bul\r\n        // İlk nokta (anlık konum) sabit, diğerleri optimize edilmiş\r\n        const newOrder = data.waypoints.slice(1).sort(\r\n          (a: any, b: any) => a.waypoint_index - b.waypoint_index\r\n        );\r\n        const newIds = newOrder.map((wp: any) => {\r\n          // Koordinat eşleşmesi ile id bul\r\n          const [lng, lat] = wp.location;\r\n          const found = selected.find(r => Math.abs(parseFloat(r.lat) - lat) < 1e-5 && Math.abs(parseFloat(r.lng) - lng) < 1e-5);\r\n          return found ? found.id : null;\r\n        }).filter(Boolean);\r\n        setRotaKaynakIds(newIds);\r\n        // Rota çizgisi ve özet\r\n        const routeCoords = data.trips[0].geometry.coordinates.map(\r\n          ([lon, lat]: [number, number]) => [lat, lon] as [number, number]\r\n        );\r\n        setRotaPolyline(routeCoords);\r\n        setRotaOzet({\r\n          mesafe: data.trips[0].distance,\r\n          sure: data.trips[0].duration\r\n        });\r\n      } else {\r\n        alert('En kısa rota bulunamadı!');\r\n      }\r\n    } catch {\r\n      alert('En kısa rota oluşturulurken hata oluştu!');\r\n    }\r\n  };\r\n\r\n  // Ana return bloğunu ve içerikleri tek bir kapsayıcı ile sarıyorum, eksik kapanışları tamamlıyorum\r\n  return (\r\n    <Box sx={{ minHeight: '100vh', bgcolor: '#f4f6fa', pb: 4 }}>\r\n      <Box sx={{ maxWidth: 900, mx: 'auto', mt: 4, mb: 2, p: { xs: 1, sm: 2 }, background: '#fff', borderRadius: 3, boxShadow: 3 }}>\r\n        <Box sx={{ maxWidth: 800, mx: 'auto', mb: 2, display: 'flex', justifyContent: 'flex-end' }}>\r\n          <Button variant=\"outlined\" startIcon={<FilterListIcon />} onClick={() => setFilterOpen(true)}>\r\n            Filtrele\r\n          </Button>\r\n        </Box>\r\n        <Drawer\r\n          anchor=\"left\"\r\n          open={filterOpen}\r\n          onClose={() => setFilterOpen(false)}\r\n          PaperProps={{\r\n            sx: {\r\n              width: { xs: '100vw', sm: 380 },\r\n              maxWidth: '100vw',\r\n              height: { xs: '100vh', sm: 'auto' },\r\n              borderRadius: { xs: 0, sm: 3 },\r\n              boxShadow: 8,\r\n              p: 0,\r\n              transition: 'all 0.3s',\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              bgcolor: '#f8fafc',\r\n            }\r\n          }}\r\n        >\r\n          <Box sx={{ width: '100%', flex: 1, display: 'flex', flexDirection: 'column', p: 0, pt: 0 }}>\r\n            {/* Sabit başlık ve kapatma butonu */}\r\n            <Box sx={{ display: 'flex', alignItems: 'center', py: 2, px: 2, borderBottom: '1px solid #e0e0e0', bgcolor: '#fff', position: 'sticky', top: 0, zIndex: 10 }}>\r\n              <FilterListIcon color=\"primary\" sx={{ mr: 1, fontSize: 30 }} />\r\n              <Typography variant=\"h6\" fontWeight={700} sx={{ fontSize: 22 }}>Filtrele</Typography>\r\n              <IconButton sx={{ ml: 'auto', fontSize: 30 }} onClick={() => setFilterOpen(false)}>\r\n                ×\r\n              </IconButton>\r\n            </Box>\r\n            <Box sx={{ flex: 1, p: { xs: 2, sm: 3 }, pt: 2, display: 'flex', flexDirection: 'column', gap: 3 }}>\r\n              <TextField\r\n                select\r\n                label=\"Kaynak Adı\"\r\n                value={filterType}\r\n                onChange={e => setFilterType(e.target.value)}\r\n                fullWidth\r\n                sx={{ fontSize: 18 }}\r\n                size=\"medium\"\r\n                InputLabelProps={{ style: { fontSize: 18 } }}\r\n                InputProps={{ style: { fontSize: 18 } }}\r\n              >\r\n                <MenuItem value=\"\">Tümü</MenuItem>\r\n                <MenuItem value=\"sivrisinek\">Sivrisinek</MenuItem>\r\n                <MenuItem value=\"karasinek\">Karasinek</MenuItem>\r\n                <MenuItem value=\"cop\">Çöp Konteynırı</MenuItem>\r\n                <MenuItem value=\"logar\">Logar</MenuItem>\r\n              </TextField>\r\n              <TextField\r\n                select\r\n                label=\"İlçe\"\r\n                value={filterIlce}\r\n                onChange={e => setFilterIlce(e.target.value)}\r\n                fullWidth\r\n                sx={{ fontSize: 18 }}\r\n                size=\"medium\"\r\n                InputLabelProps={{ style: { fontSize: 18 } }}\r\n                InputProps={{ style: { fontSize: 18 } }}\r\n              >\r\n                <MenuItem value=\"\">Tümü</MenuItem>\r\n                {ilceler.map(ilce => (\r\n                  <MenuItem key={ilce} value={ilce}>{ilce}</MenuItem>\r\n                ))}\r\n              </TextField>\r\n              <TextField\r\n                select\r\n                label=\"Mahalle\"\r\n                value={filterMahalle}\r\n                onChange={e => setFilterMahalle(e.target.value)}\r\n                fullWidth\r\n                sx={{ fontSize: 18 }}\r\n                size=\"medium\"\r\n                InputLabelProps={{ style: { fontSize: 18 } }}\r\n                InputProps={{ style: { fontSize: 18 } }}\r\n              >\r\n                <MenuItem value=\"\">Tümü</MenuItem>\r\n                {mahalleler.map(mahalle => (\r\n                  <MenuItem key={mahalle} value={mahalle}>{mahalle}</MenuItem>\r\n                ))}\r\n              </TextField>\r\n            </Box>\r\n            {/* Alt kısımda sabit butonlar */}\r\n            <Box sx={{ px: 2, pb: 2, pt: 1, borderTop: '1px solid #e0e0e0', bgcolor: '#fff', position: 'sticky', bottom: 0, zIndex: 10, display: 'flex', gap: 2 }}>\r\n              <Button\r\n                variant=\"outlined\"\r\n                color=\"secondary\"\r\n                fullWidth\r\n                sx={{ py: 1.3, fontSize: 17, fontWeight: 600, borderRadius: 2 }}\r\n                onClick={() => {\r\n                  setFilterType('');\r\n                  setFilterIlce('');\r\n                  setFilterMahalle('');\r\n                }}\r\n              >\r\n                Sıfırla\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                fullWidth\r\n                sx={{ py: 1.3, fontSize: 17, fontWeight: 700, borderRadius: 2 }}\r\n                onClick={() => setFilterOpen(false)}\r\n              >\r\n                Uygula\r\n              </Button>\r\n            </Box>\r\n          </Box>\r\n        </Drawer>\r\n        <Paper elevation={3} sx={{ p: { xs: 1, sm: 2 }, maxWidth: 800, mx: 'auto', mb: 4 }}>\r\n          {/* Toplu seçim barı */}\r\n          {selectedResourceIds.length > 0 && (\r\n            <Box sx={{\r\n              display: 'flex', justifyContent: 'flex-end', mb: 1, gap: 2,\r\n              flexDirection: { xs: 'column', sm: 'row' },\r\n              alignItems: { xs: 'stretch', sm: 'center' },\r\n            }}>\r\n              <Typography color=\"primary\" fontWeight={700} sx={{ fontSize: { xs: 16, sm: 18 } }}>\r\n                {selectedResourceIds.length} kaynak seçildi\r\n              </Typography>\r\n              <Button variant=\"contained\" color=\"success\" size=\"large\" sx={{ fontSize: { xs: 16, sm: 14 }, py: { xs: 1.2, sm: 0.5 } }} onClick={handleBulkIlacla}>\r\n                Toplu İlaçla\r\n              </Button>\r\n              <Button variant=\"outlined\" color=\"error\" size=\"large\" sx={{ fontSize: { xs: 16, sm: 14 }, py: { xs: 1.2, sm: 0.5 } }} onClick={handleClearSelection}>\r\n                Seçimi Temizle\r\n              </Button>\r\n            </Box>\r\n          )}\r\n          <Box sx={{ width: '100%', height: { xs: 'calc(100vh - 56px)', sm: 500 }, borderRadius: { xs: 0, sm: 2 }, overflow: 'hidden', mb: 1, mt: 1, position: 'relative', boxShadow: 3 }}>\r\n            <MapContainer center={center} zoom={8} style={{ width: '100%', height: '100%' }} ref={mapRef}>\r\n              <LayersControl position=\"topright\">\r\n                <LayersControl.BaseLayer checked name=\"Sokak Haritası (OSM)\">\r\n                  <TileLayer\r\n                    attribution='&copy; OpenStreetMap contributors'\r\n                    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                  />\r\n                </LayersControl.BaseLayer>\r\n                <LayersControl.BaseLayer name=\"Uydu (Esri)\">\r\n                  <TileLayer\r\n                    attribution='Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'\r\n                    url=\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\r\n                  />\r\n                </LayersControl.BaseLayer>\r\n                <LayersControl.BaseLayer name=\"Topoğrafya (OpenTopoMap)\">\r\n                  <TileLayer\r\n                    attribution='Map data: &copy; OpenTopoMap (CC-BY-SA)'\r\n                    url=\"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png\"\r\n                  />\r\n                </LayersControl.BaseLayer>\r\n                <LayersControl.Overlay checked name=\"İşaretler\">\r\n                  <LayerGroup>\r\n                    {markers.map((marker, idx) => (\r\n                      <Marker key={marker.id || idx} position={[marker.lat, marker.lng]} />\r\n                    ))}\r\n                  </LayerGroup>\r\n                </LayersControl.Overlay>\r\n                <LayersControl.Overlay checked name=\"Kaynaklar\">\r\n                  <LayerGroup>\r\n                    <MarkerClusterGroup>\r\n                      {/* Rota planlayıcıda seçili kaynaklar için özel marker */}\r\n                      {rotaFilteredResources.map((res: any, idx: number) => {\r\n                        const isRotaSelected = rotaKaynakIds.includes(res.id);\r\n                        if (!isRotaSelected) return null;\r\n                        // Sıra numarasını bul\r\n                        const order = rotaKaynakIds.indexOf(res.id);\r\n                        return (\r\n                          <Marker\r\n                            key={`rota-${res.id}`}\r\n                            position={[parseFloat(res.lat), parseFloat(res.lng)]}\r\n                            icon={L.divIcon({\r\n                              html: `<div style='position:relative;display:flex;align-items:center;justify-content:center;'>\r\n                                <img src='https://cdn-icons-png.flaticon.com/512/684/684908.png' style='width:36px;height:36px;'/>\r\n                                <div style='position:absolute;top:-8px;right:-8px;background:#1976d2;color:white;font-size:14px;font-weight:bold;border-radius:50%;width:22px;height:22px;display:flex;align-items:center;justify-content:center;border:2px solid #fff;'>${order+1}</div>\r\n                              </div>`\r\n                            })}\r\n                          >\r\n                            <Tooltip>Rota Noktası #{order+1}</Tooltip>\r\n                          </Marker>\r\n                        );\r\n                      })}\r\n                      {/* Diğer kaynak markerları */}\r\n                      {filteredResources.map((res: any, idx: number) => {\r\n                        // Kalan süreyi hesapla (saniye cinsinden)\r\n                        let kalanSn = null;\r\n                        if (res.ilaclandiMi && res.ilaclamaZamani) {\r\n                          const sure = ilaclanmaSureleri[res.type] || { gun: 15, saat: 0, dakika: 0 };\r\n                          const gun = Number(sure.gun) || 0;\r\n                          const saat = Number(sure.saat) || 0;\r\n                          const dakika = Number(sure.dakika) || 0;\r\n                          const ILACLAMA_SURESI = (gun * 24 * 60 * 60) + (saat * 60 * 60) + (dakika * 60);\r\n                          const start = new Date(res.ilaclamaZamani).getTime();\r\n                          const now = Date.now();\r\n                          const diff = Math.floor((now - start) / 1000);\r\n                          kalanSn = ILACLAMA_SURESI - diff;\r\n                        }\r\n                        // Her zaman kendi iconu gösterilecek\r\n                        let iconUrl = resourceTypeIcons[res.type] || resourceTypeIcons['sivrisinek'];\r\n                        let tooltipText = res.type;\r\n                        const isSelected = selectedResourceIds.includes(res.id);\r\n                        const isSearched = searchMatchedId === res.id;\r\n                        return (\r\n                          <Marker\r\n                            key={res.id || idx}\r\n                            position={[parseFloat(res.lat), parseFloat(res.lng)]}\r\n                            icon={L.icon({\r\n                              iconUrl,\r\n                              iconSize: isSearched ? [44, 44] : isSelected ? [38, 38] : [28, 28],\r\n                              iconAnchor: [isSearched ? 22 : isSelected ? 19 : 14, isSearched ? 44 : isSelected ? 38 : 28],\r\n                              popupAnchor: [0, -28],\r\n                              className: isSearched ? 'searched-marker' : isSelected ? 'selected-marker' : '',\r\n                            })}\r\n                            eventHandlers={{\r\n                              click: () => handleSelectResource(res.id)\r\n                            }}\r\n                          >\r\n                            <Popup minWidth={260} maxWidth={420}>\r\n                              <Box sx={{\r\n                                p: { xs: 1.5, sm: 2 },\r\n                                minWidth: { xs: '90vw', sm: 260 },\r\n                                maxWidth: { xs: '98vw', sm: 420 },\r\n                                borderRadius: 3,\r\n                                boxShadow: 6,\r\n                                bgcolor: '#fff',\r\n                                display: 'flex',\r\n                                flexDirection: 'column',\r\n                                gap: 1.2,\r\n                                '@media (max-width:600px)': {\r\n                                  minWidth: '98vw',\r\n                                  maxWidth: '99vw',\r\n                                  px: 2,\r\n                                  py: 2,\r\n                                  borderRadius: 0,\r\n                                }\r\n                              }}>\r\n                                <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 1 }}>\r\n                                  <Avatar src={resourceTypeIcons[res.type] || ''} sx={{ width: 38, height: 38, bgcolor: '#e3f2fd' }} />\r\n                                  <Typography variant=\"h6\" color=\"primary\" fontWeight={700} sx={{ fontSize: { xs: 18, sm: 20 } }}>\r\n                                    {res.type?.charAt(0).toUpperCase() + res.type?.slice(1)}\r\n                                  </Typography>\r\n                                </Box>\r\n                                {res.adres && <Typography variant=\"body2\"><b>Adres:</b> {res.adres}</Typography>}\r\n                                {res.ilce && <Typography variant=\"body2\"><b>İlçe:</b> {res.ilce}</Typography>}\r\n                                {res.mahalle && <Typography variant=\"body2\"><b>Mahalle:</b> {res.mahalle}</Typography>}\r\n                                {res.aciklama && <Typography variant=\"body2\"><b>Açıklama:</b> {res.aciklama}</Typography>}\r\n                                {res.tarih && <Typography variant=\"body2\"><b>Tarih:</b> {res.tarih}</Typography>}\r\n                                <Typography variant=\"body2\" sx={{ mt: 1 }}>\r\n                                  <b>Son İlaçlama:</b> {res.ilaclamaZamani ? new Date(res.ilaclamaZamani).toLocaleString('tr-TR') : '-'}\r\n                                </Typography>\r\n                                <Typography variant=\"body2\">\r\n                                  <b>Kalan Süre:</b> {kalanSure(res)}\r\n                                </Typography>\r\n                                {res.resim && (\r\n                                  <Box sx={{ mt: 1, mb: 1, textAlign: 'center' }}>\r\n                                    <img src={res.resim} alt=\"Kaynak\" style={{ width: 100, height: 100, objectFit: 'cover', borderRadius: 10, border: '1px solid #eee' }} />\r\n                                  </Box>\r\n                                )}\r\n                                <Button variant=\"contained\" color=\"success\" size=\"large\" fullWidth sx={{ mt: 1, fontSize: { xs: 17, sm: 15 }, py: { xs: 1.3, sm: 0.7 }, borderRadius: 2 }} onClick={() => handleIlacla(res)}>\r\n                                  İlaçlandı Olarak İşaretle\r\n                                </Button>\r\n                              </Box>\r\n                            </Popup>\r\n                            <Tooltip>{tooltipText}</Tooltip>\r\n                          </Marker>\r\n                        );\r\n                      })}\r\n                    </MarkerClusterGroup>\r\n                  </LayerGroup>\r\n                </LayersControl.Overlay>\r\n                {rotaPolyline.length > 1 && (\r\n                  <Polyline\r\n                    positions={rotaPolyline}\r\n                    pathOptions={{ color: 'blue', weight: 5, opacity: 0.8 }}\r\n                  />\r\n                )}\r\n                {myPosition && (\r\n                  <LayersControl.Overlay checked name=\"Kendi Konumunuz\">\r\n                    <LayerGroup>\r\n                      <Circle center={myPosition} radius={15} pathOptions={{ color: '#1976d2', fillColor: '#1976d2', fillOpacity: 0.2 }}>\r\n                        <Tooltip>Kendi Konumunuz</Tooltip>\r\n                      </Circle>\r\n                    </LayerGroup>\r\n                  </LayersControl.Overlay>\r\n                )}\r\n              </LayersControl>\r\n              <GoToMyLocation position={myPosition} />\r\n            </MapContainer>\r\n          </Box>\r\n        </Paper>\r\n        {/* Mini istatistik paneli haritadan tamamen bağımsız */}\r\n        <Box sx={{\r\n          maxWidth: 800,\r\n          mx: 'auto',\r\n          mb: 2,\r\n          mt: 1,\r\n          px: { xs: 1, sm: 0 },\r\n          display: 'flex',\r\n          justifyContent: 'flex-end',\r\n        }}>\r\n          <Box sx={{\r\n            bgcolor: 'rgba(255,255,255,0.92)',\r\n            boxShadow: 3,\r\n            borderRadius: 2,\r\n            px: 2,\r\n            py: 1,\r\n            minWidth: 160,\r\n            fontSize: 15,\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            gap: 0.5,\r\n            '@media (max-width:600px)': {\r\n              minWidth: 0,\r\n              px: 1,\r\n              py: 0.5,\r\n              fontSize: 13,\r\n            }\r\n          }}>\r\n            <Typography fontWeight={700} color=\"primary\" sx={{ fontSize: { xs: 15, sm: 16 } }}>İstatistikler</Typography>\r\n            <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>\r\n              <span>Toplam:</span>\r\n              <b>{toplamKaynak}</b>\r\n            </Box>\r\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', color: '#43ea6d' }}>\r\n              <span>Aktif:</span>\r\n              <b>{aktifKaynak}</b>\r\n            </Box>\r\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', color: '#ff9800' }}>\r\n              <span>Kritik:</span>\r\n              <b>{kritikKaynak}</b>\r\n            </Box>\r\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', color: '#ff5e5e' }}>\r\n              <span>Süresi Dolan:</span>\r\n              <b>{dolanKaynak}</b>\r\n            </Box>\r\n          </Box>\r\n        </Box>\r\n        {/* Kaynak Rota Planlayıcı */}\r\n        <Box sx={{ maxWidth: 800, mx: 'auto', mb: 2, mt: 2, p: 2, background: '#f8fafc', borderRadius: 2, border: '1px solid #e0e0e0',\r\n          boxShadow: 2,\r\n          '@media (max-width:600px)': {\r\n            p: 1,\r\n            borderRadius: 1,\r\n          }\r\n        }}>\r\n          <Typography variant=\"h6\" color=\"primary\" fontWeight={700} sx={{ mb: 2, fontSize: { xs: 18, sm: 22 } }}>Kaynak Rota Planlayıcı</Typography>\r\n          {/* Seçili kaynakların sıralı listesi ve ok tuşları */}\r\n          {rotaKaynakIds.length > 0 && (\r\n            <Box sx={{ mb: 2 }}>\r\n              <Typography fontWeight={600} sx={{ mb: 1, fontSize: { xs: 15, sm: 16 } }}>Rota Sırası:</Typography>\r\n              <List dense sx={{ bgcolor: '#fff', borderRadius: 1, boxShadow: 1, p: 0 }}>\r\n                {rotaKaynakIds.map((id, idx) => {\r\n                  const r = rotaFilteredResources.find(x => x.id === id);\r\n                  if (!r) return null;\r\n                  return (\r\n                    <ListItem key={id} secondaryAction={\r\n                      <Box sx={{ display: 'flex', gap: { xs: 0.5, sm: 1 } }}>\r\n                        <IconButton size=\"medium\" disabled={idx === 0} onClick={() => {\r\n                          if (idx === 0) return;\r\n                          const newIds = [...rotaKaynakIds];\r\n                          [newIds[idx - 1], newIds[idx]] = [newIds[idx], newIds[idx - 1]];\r\n                          setRotaKaynakIds(newIds);\r\n                        }} sx={{ fontSize: { xs: 22, sm: 18 } }}>\r\n                          <span style={{fontSize:22}}>↑</span>\r\n                        </IconButton>\r\n                        <IconButton size=\"medium\" disabled={idx === rotaKaynakIds.length - 1} onClick={() => {\r\n                          if (idx === rotaKaynakIds.length - 1) return;\r\n                          const newIds = [...rotaKaynakIds];\r\n                          [newIds[idx + 1], newIds[idx]] = [newIds[idx], newIds[idx + 1]];\r\n                          setRotaKaynakIds(newIds);\r\n                        }} sx={{ fontSize: { xs: 22, sm: 18 } }}>\r\n                          <span style={{fontSize:22}}>↓</span>\r\n                        </IconButton>\r\n                        {/* Haritada göster butonu */}\r\n                        <IconButton size=\"medium\" onClick={() => {\r\n                          if (mapRef.current && r.lat && r.lng) {\r\n                            mapRef.current.setView([parseFloat(r.lat), parseFloat(r.lng)], 16);\r\n                          }\r\n                        }} title=\"Haritada Göster\" sx={{ fontSize: { xs: 22, sm: 18 } }}>\r\n                          <span style={{fontSize:22}}>📍</span>\r\n                        </IconButton>\r\n                        {/* Listeden çıkar butonu */}\r\n                        <IconButton size=\"medium\" color=\"error\" onClick={() => {\r\n                          setRotaKaynakIds(rotaKaynakIds.filter(x => x !== id));\r\n                        }} title=\"Listeden Çıkar\" sx={{ fontSize: { xs: 22, sm: 18 } }}>\r\n                          <span style={{fontSize:22}}>✕</span>\r\n                        </IconButton>\r\n                      </Box>\r\n                    }>\r\n                      <ListItemText primary={`${idx + 1}. ${r.type} - ${r.ilce} / ${r.mahalle}`} sx={{ fontSize: { xs: 15, sm: 16 } }} />\r\n                    </ListItem>\r\n                  );\r\n                })}\r\n              </List>\r\n              {/* Rota özeti */}\r\n              {rotaOzet && (\r\n                <Box sx={{ mt: 2, p: 1, bgcolor: '#e3f2fd', borderRadius: 1, display: 'flex', gap: 3, fontWeight: 600, fontSize: { xs: 14, sm: 15 }, flexDirection: { xs: 'column', sm: 'row' } }}>\r\n                  <span>Toplam Mesafe: {(rotaOzet.mesafe / 1000).toFixed(2)} km</span>\r\n                  <span>Tahmini Süre: {(rotaOzet.sure / 60).toFixed(0)} dk</span>\r\n                </Box>\r\n              )}\r\n            </Box>\r\n          )}\r\n          <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 2, mb: 2, flexDirection: { xs: 'column', sm: 'row' } }}>\r\n            <TextField\r\n              select\r\n              label=\"Kaynak Türü\"\r\n              value={rotaType}\r\n              onChange={e => setRotaType(e.target.value)}\r\n              size=\"small\"\r\n              sx={{ minWidth: 160 }}\r\n            >\r\n              <MenuItem value=\"\">Tümü</MenuItem>\r\n              <MenuItem value=\"sivrisinek\">Sivrisinek</MenuItem>\r\n              <MenuItem value=\"karasinek\">Karasinek</MenuItem>\r\n              <MenuItem value=\"cop\">Çöp Konteynırı</MenuItem>\r\n              <MenuItem value=\"logar\">Logar</MenuItem>\r\n            </TextField>\r\n            <TextField\r\n              select\r\n              label=\"İlçe\"\r\n              value={rotaIlce}\r\n              onChange={e => setRotaIlce(e.target.value)}\r\n              size=\"small\"\r\n              sx={{ minWidth: 160 }}\r\n            >\r\n              <MenuItem value=\"\">Tümü</MenuItem>\r\n              {ilceler.map(ilce => (\r\n                <MenuItem key={ilce} value={ilce}>{ilce}</MenuItem>\r\n              ))}\r\n            </TextField>\r\n            <TextField\r\n              select\r\n              label=\"Mahalle\"\r\n              value={rotaMahalle}\r\n              onChange={e => setRotaMahalle(e.target.value)}\r\n              size=\"small\"\r\n              sx={{ minWidth: 160 }}\r\n            >\r\n              <MenuItem value=\"\">Tümü</MenuItem>\r\n              {mahalleler.map(mahalle => (\r\n                <MenuItem key={mahalle} value={mahalle}>{mahalle}</MenuItem>\r\n              ))}\r\n            </TextField>\r\n            <TextField\r\n              select\r\n              label=\"Kaynak Adı\"\r\n              value={rotaKaynakIds}\r\n              onChange={e => setRotaKaynakIds(typeof e.target.value === 'string' ? e.target.value.split(',') : e.target.value)}\r\n              size=\"small\"\r\n              sx={{ minWidth: 200, flex: 1 }}\r\n              SelectProps={{ multiple: true, renderValue: (selected) => (selected as string[]).map(id => {\r\n                const r = rotaFilteredResources.find(x => x.id === id);\r\n                return r ? `${r.type} - ${r.ilce} / ${r.mahalle}` : id;\r\n              }).join(', ') }}\r\n            >\r\n              {rotaFilteredResources.map(r => (\r\n                <MenuItem key={r.id} value={r.id}>{r.type} - {r.ilce} / {r.mahalle}</MenuItem>\r\n              ))}\r\n            </TextField>\r\n          </Box>\r\n          <Box sx={{ display: 'flex', gap: 2 }}>\r\n            <Button variant=\"contained\" color=\"primary\" disabled={rotaKaynakIds.length < 2 || rotaLoading} onClick={handleRotaOlustur} sx={{ width: { xs: '100%', sm: 'auto' }, fontSize: { xs: 16, sm: 15 }, py: { xs: 1.2, sm: 0.5 } }}>\r\n              {rotaLoading ? 'Rota Oluşturuluyor...' : 'Rota Oluştur'}\r\n            </Button>\r\n            <Button variant=\"outlined\" color=\"secondary\" onClick={handleRotaTemizle} disabled={rotaPolyline.length === 0 && rotaKaynakIds.length === 0} sx={{ width: { xs: '100%', sm: 'auto' }, fontSize: { xs: 16, sm: 15 }, py: { xs: 1.2, sm: 0.5 } }}>\r\n              Temizle\r\n            </Button>\r\n            <Button variant=\"contained\" color=\"success\" disabled={rotaKaynakIds.length < 2} onClick={handleEnKisaRota} sx={{ width: { xs: '100%', sm: 'auto' }, fontSize: { xs: 16, sm: 15 }, py: { xs: 1.2, sm: 0.5 } }}>\r\n              En Kısa Rota\r\n            </Button>\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default MapPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}